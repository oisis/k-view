services:
  k-view:
    build:
      context: .
      args:
        TARGETARCH: arm64  # Change to amd64 if needed
    image: k-view-dev:latest
    ports:
      - "8080:8080"
    environment:
      # These take precedence over .env file
      DEV_MODE: ${DEV_MODE:-true}
      GIN_MODE: ${GIN_MODE:-debug}
      PORT: ${PORT:-8080}
      KVIEW_STATIC_USERS: ${KVIEW_STATIC_USERS:-'[{"username":"admin","password_hash":"$$2b$$12$$/rN33LSSA6EdI6RGnsfRquX.Xv.DwAXsO/4HIkxzgW9.MowFPzAQC"}]'}
    env_file:
      - .env
    volumes:
      - ./config/rbac:/etc/kview/rbac:ro
