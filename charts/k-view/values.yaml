# Default values for k-view.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# -- Number of replicas for the K-View application pod
replicaCount: 1

image:
  # -- Repository containing the K-View image
  repository: ghcr.io/oisis/k-view
  # -- Image pull policy (Always, IfNotPresent, Never)
  pullPolicy: IfNotPresent
  # -- Overrides the image tag whose default is the chart appVersion
  tag: "0.14.0"

# -- Optionally specify an array of imagePullSecrets.
# Secrets must be manually created in the namespace.
imagePullSecrets: []

# -- Overrides the name of the chart.
nameOverride: ""

# -- Overrides the full name of the resources.
fullnameOverride: ""

serviceAccount:
  # -- Specifies whether a service account should be created
  create: true
  # -- Annotations to add to the service account
  annotations: {}
  # -- The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: "k-view-sa"

# -- Annotations to add to the pod
podAnnotations: {}

# -- Pod-level security context
podSecurityContext:
  fsGroup: 1000

# -- Container-level security context
# Ensures the container runs as a non-root user (1000) for better security
securityContext:
  runAsUser: 1000
  runAsGroup: 1000

service:
  # -- Service type (ClusterIP, NodePort, LoadBalancer)
  type: ClusterIP
  # -- Port on which the service will be exposed
  port: 80

ingress:
  # -- Enable ingress controller resource
  enabled: false
  # -- Defines which ingress controller will implement the resource
  className: "traefik"
  # -- Additional annotations for the Ingress resource.
  # IMPORTANT: WebSocket support is REQUIRED for the Exec terminal feature to work.
  annotations: {}
  # For NGINX Ingress Controller (className: nginx), uncomment and add:
  #   nginx.ingress.kubernetes.io/proxy-read-timeout: "3600"
  #   nginx.ingress.kubernetes.io/proxy-send-timeout: "3600"
  # For Traefik (className: traefik), if `traefik.websocketMiddleware.enabled: true`,
  # this annotation is added automatically - no manual change needed.
  # -- Ingress hostnames and routable paths
  hosts:
    - host: kview.local
      paths:
        - path: /
          pathType: ImplementationSpecific

  # -- TLS configuration for the ingress resource
  tls: []
  #  - secretName: k-view-tls
  #    hosts:
  #      - kview.local

# -- Traefik-specific configuration
traefik:
  websocketMiddleware:
    # -- If true and className is "traefik", creates a Traefik Middleware resource
    # and automatically adds the required router.middlewares annotation to the Ingress.
    # This is required for the Exec terminal (WebSocket) feature to work correctly.
    enabled: false

# We usually recommend not to specify default resources and to leave this as a conscious
# choice for the user. This also increases chances charts run on environments with little
# resources, such as Minikube.
resources: {}
  # limits:
  #   cpu: 100m
  #   memory: 256Mi
  # requests:
  #   cpu: 10m
  #   memory: 64Mi

# -- Persistence configuration for the application data
# Ensures that user data is not lost upon pod restarts.
persistence:
  # -- Enable Persistent Volume Claim creation
  enabled: false
  # -- Volume size
  size: 1Gi
  # -- Access mode for the volume
  accessMode: ReadWriteOnce
  # -- Storage class name. Leave empty to use default storage class.
  # storageClass: "standard"

# -- Application-specific environment variables
env:
  # -- Sets the Gin framework mode (use 'release' for production, 'debug' for development)
  ginMode: "release"
  # -- Timezone for the pod logs (e.g., "Europe/Warsaw")
  timezone: "UTC"
  # -- OAuth 2.0 Redirect URL configured in your Google Cloud Console.
  # This must exactly match the Authorized redirect URI, including the domain and scheme.
  oauthRedirectUrl: "http://kview.local/api/auth/callback"

# -- Enable Google SSO (OIDC) authentication
enable_sso: false

# -- Sensitive credentials for Google OIDC SSO
# In a production environment, it is highly recommended to manage these external to Helm
# (e.g., using External Secrets Operator, AWS Secrets Manager, or HashiCorp Vault)
# rather than passing them directly via values.yaml.
secrets:
  # -- Your Google OAuth 2.0 Client ID
  googleClientId: "YOUR_GOOGLE_CLIENT_ID"
  # -- Your Google OAuth 2.0 Client Secret
  googleClientSecret: "YOUR_GOOGLE_CLIENT_SECRET"

# -- Local Static Users (for environments without OIDC)
# The `role` field maps this user to a k-view RBAC role automatically.
# Valid roles: kview-cluster-admin, kview-cluster-developer, kview-cluster-viewer,
#              kview-namespace-admin, kview-namespace-developer, kview-namespace-viewer
localUsers: []
#  - username: "admin"
#    password_hash: "$2a$10$6D0aK9B7C7141P3cKxj2rOfzLntIfg6qYg62H9iMw1jO2XlE2C60C"
#    role: "kview-cluster-admin"

# -- Array of raw Kubernetes manifests to be deployed alongside the chart.
# These can be any valid Kubernetes object.
# @default -- []
extraObjects: []
#  - apiVersion: v1
#    kind: ConfigMap
#    metadata:
#      name: extra-config
#    data:
#      key: value

# -- Declarative RBAC configurations for K-View
rbac:
  # -- Enable or disable the declarative RBAC system
  enabled: true
  
  # -- List of RBAC assignments mapping identities to Kubernetes Roles
  assignments: []
  # Example:
  # - name: "admin-user"
  #   subjectType: "User"
  #   subjects:
  #     - "admin@kview.local"
  #   roleName: "kview-cluster-admin"
  # - name: "dev-team-namespace"
  #   subjectType: "Group"
  #   subjects:
  #     - "developers@example.com"
  #   roleName: "kview-namespace-developer"
  #   namespace: "dev-namespace"
